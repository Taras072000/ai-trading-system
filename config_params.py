"""
–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Å–∏—Å—Ç–µ–º–Ω—ã—Ö —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–π –¥–ª—è Peper Binance v4
–≠—Ç–æ—Ç —Ñ–∞–π–ª —Å–æ–¥–µ—Ä–∂–∏—Ç –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ –∏ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ —Å–∏—Å—Ç–µ–º–µ
"""

import os
from dataclasses import dataclass
from typing import Dict, Any, Optional

@dataclass
class SystemRequirements:
    """–ö–ª–∞—Å—Å –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è —Å–∏—Å—Ç–µ–º–Ω—ã—Ö —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–π"""
    
    # –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è
    min_ram_gb: float
    min_cpu_cores: int
    min_disk_space_gb: float
    min_python_version: tuple
    
    # –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è
    recommended_ram_gb: float
    recommended_cpu_cores: int
    recommended_disk_space_gb: float
    
    # –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –¥–ª—è AI –º–æ–¥—É–ª–µ–π
    ai_min_ram_gb: float
    ai_recommended_ram_gb: float
    
    # –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Å–∏—Å—Ç–µ–º—ã
    supported_os: list
    
    # –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ GPU (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
    gpu_memory_gb: Optional[float] = None
    cuda_support: bool = False

# –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–π –¥–ª—è Peper Binance v4
SYSTEM_REQUIREMENTS = SystemRequirements(
    # –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –¥–ª—è –±–∞–∑–æ–≤–æ–π —Ä–∞–±–æ—Ç—ã
    min_ram_gb=4.0,
    min_cpu_cores=2,
    min_disk_space_gb=2.0,
    min_python_version=(3, 8),
    
    # –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –¥–ª—è –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–π —Ä–∞–±–æ—Ç—ã
    recommended_ram_gb=8.0,
    recommended_cpu_cores=4,
    recommended_disk_space_gb=5.0,
    
    # –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –¥–ª—è AI –º–æ–¥—É–ª–µ–π (–≤–∫–ª—é—á–∞—è Mistral 7B)
    ai_min_ram_gb=8.0,          # –ú–∏–Ω–∏–º—É–º –¥–ª—è —Ä–∞–±–æ—Ç—ã AI
    ai_recommended_ram_gb=16.0,  # –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º–æ –¥–ª—è AI
    
    # –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ –û–°
    supported_os=['Darwin', 'Linux', 'Windows'],
    
    # GPU —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ –¥–ª—è —É—Å–∫–æ—Ä–µ–Ω–∏—è AI)
    gpu_memory_gb=4.0,
    cuda_support=True
)

# –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
CONFIG_PARAMS = {
    # –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
    'performance': {
        'max_workers': int(os.getenv('MAX_WORKERS', '2')),  # –û–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤–æ—Ä–∫–µ—Ä–æ–≤
        'memory_limit_mb': int(os.getenv('MEMORY_LIMIT_MB', '512')),  # –õ–∏–º–∏—Ç –ø–∞–º—è—Ç–∏ –≤ –ú–ë
        'cpu_usage_limit': float(os.getenv('CPU_USAGE_LIMIT', '0.8')),  # –õ–∏–º–∏—Ç CPU (80%)
        'max_concurrent_trades': 10,
        'api_request_timeout': 30,
        'data_update_interval': 1,  # —Å–µ–∫—É–Ω–¥—ã
    },
    
    # –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ —Ä–µ—Å—É—Ä—Å–æ–≤
    'monitoring': {
        'check_interval': 30,  # –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–∞–∂–¥—ã–µ 30 —Å–µ–∫—É–Ω–¥
        'memory_threshold': 0.85,  # –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ –ø—Ä–∏ 85% –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –ø–∞–º—è—Ç–∏
        'cpu_threshold': 0.90,  # –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ –ø—Ä–∏ 90% –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è CPU
        'auto_cleanup': True  # –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—á–∏—Å—Ç–∫–∞ –ø–∞–º—è—Ç–∏
    },
    
    # –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è
    'cache': {
        'max_size': 100,  # –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä –∫—ç—à–∞
        'ttl': 3600,  # –í—Ä–µ–º—è –∂–∏–∑–Ω–∏ –∫—ç—à–∞ –≤ —Å–µ–∫—É–Ω–¥–∞—Ö
        'cleanup_interval': 300  # –û—á–∏—Å—Ç–∫–∞ –∫—ç—à–∞ –∫–∞–∂–¥—ã–µ 5 –º–∏–Ω—É—Ç
    },
    
    # –ù–∞—Å—Ç—Ä–æ–π–∫–∏ AI –º–æ–¥—É–ª–µ–π
    'ai_modules': {
        'trading_ai': {
            'enabled': True,
            'priority': 'high',
            'memory_limit_mb': 512
        },
        'lava_ai': {
            'enabled': True,
            'priority': 'medium',
            'memory_limit_mb': 256
        },
        'mistral_ai': {
            'enabled': True,
            'priority': 'low',
            'memory_limit_mb': 4096,  # –¢—Ä–µ–±—É–µ—Ç –±–æ–ª—å—à–µ –ø–∞–º—è—Ç–∏
            'fallback_mode': True,    # –ú–æ–∂–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –≤ —Ä–µ–∂–∏–º–µ –∑–∞–≥–ª—É—à–∫–∏
            'min_ram_gb': 8.0
        },
        'lgbm_ai': {
            'enabled': True,
            'priority': 'high',
            'memory_limit_mb': 1024
        }
    },
    
    # –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
    'security': {
        'max_position_size': 0.1,  # 10% –æ—Ç –¥–µ–ø–æ–∑–∏—Ç–∞
        'stop_loss_percent': 2.0,
        'daily_loss_limit': 5.0
    },
    
    # –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
    'logging': {
        'level': 'INFO',
        'max_file_size_mb': 100,
        'backup_count': 5
    }
}

# –°–æ–æ–±—â–µ–Ω–∏—è –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
MESSAGES = {
    'system_check_passed': "‚úÖ –°–∏—Å—Ç–µ–º–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –≤—Å–µ–º —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º. –í—Å–µ AI –º–æ–¥—É–ª–∏ –±—É–¥—É—Ç –∞–∫—Ç–∏–≤–Ω—ã.",
    'system_check_warning': "‚ö†Ô∏è  –°–∏—Å—Ç–µ–º–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–º —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º, –Ω–æ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –º–æ–∂–µ—Ç –±—ã—Ç—å —Å–Ω–∏–∂–µ–Ω–∞.",
    'mistral_disabled': "üîÑ Mistral AI –æ—Ç–∫–ª—é—á–µ–Ω –∏–∑-–∑–∞ –Ω–µ–¥–æ—Å—Ç–∞—Ç–∫–∞ —Ä–µ—Å—É—Ä—Å–æ–≤. –í–∏–Ω—Ä–µ–π—Ç –º–æ–∂–µ—Ç –±—ã—Ç—å –Ω–∏–∂–µ –∑–∞—è–≤–ª–µ–Ω–Ω–æ–≥–æ.",
    'system_check_failed': "‚ùå –°–∏—Å—Ç–µ–º–∞ –Ω–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–º —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º. –ó–∞–ø—É—Å–∫ –Ω–µ–≤–æ–∑–º–æ–∂–µ–Ω.",
    'performance_warning': "‚ö†Ô∏è  –í–Ω–∏–º–∞–Ω–∏–µ: –ü—Ä–∏ —Ç–µ–∫—É—â–∏—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–∞—Ö —Å–∏—Å—Ç–µ–º—ã –≤–∏–Ω—Ä–µ–π—Ç –º–æ–∂–µ—Ç –±—ã—Ç—å –Ω–∏–∂–µ –∑–∞—è–≤–ª–µ–Ω–Ω–æ–≥–æ."
}

def get_requirement_description() -> str:
    """–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –æ–ø–∏—Å–∞–Ω–∏–µ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–π"""
    req = SYSTEM_REQUIREMENTS
    
    description = f"""
=== –°–∏—Å—Ç–µ–º–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è Peper Binance v4 ===

–ú–ò–ù–ò–ú–ê–õ–¨–ù–´–ï –¢–†–ï–ë–û–í–ê–ù–ò–Ø:
‚Ä¢ –û–ó–£: {req.min_ram_gb} –ì–ë
‚Ä¢ –ü—Ä–æ—Ü–µ—Å—Å–æ—Ä: {req.min_cpu_cores} —è–¥—Ä–∞
‚Ä¢ –°–≤–æ–±–æ–¥–Ω–æ–µ –º–µ—Å—Ç–æ: {req.min_disk_space_gb} –ì–ë
‚Ä¢ Python: {req.min_python_version[0]}.{req.min_python_version[1]}+

–†–ï–ö–û–ú–ï–ù–î–£–ï–ú–´–ï –¢–†–ï–ë–û–í–ê–ù–ò–Ø:
‚Ä¢ –û–ó–£: {req.recommended_ram_gb} –ì–ë
‚Ä¢ –ü—Ä–æ—Ü–µ—Å—Å–æ—Ä: {req.recommended_cpu_cores} —è–¥—Ä–∞
‚Ä¢ –°–≤–æ–±–æ–¥–Ω–æ–µ –º–µ—Å—Ç–æ: {req.recommended_disk_space_gb} –ì–ë

–î–õ–Ø AI –ú–û–î–£–õ–ï–ô:
‚Ä¢ –ú–∏–Ω–∏–º—É–º –û–ó–£: {req.ai_min_ram_gb} –ì–ë
‚Ä¢ –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º–æ –û–ó–£: {req.ai_recommended_ram_gb} –ì–ë

–û–ü–¶–ò–û–ù–ê–õ–¨–ù–û (–¥–ª—è —É—Å–∫–æ—Ä–µ–Ω–∏—è):
‚Ä¢ GPU –ø–∞–º—è—Ç—å: {req.gpu_memory_gb} –ì–ë
‚Ä¢ CUDA –ø–æ–¥–¥–µ—Ä–∂–∫–∞: {'–î–∞' if req.cuda_support else '–ù–µ—Ç'}

–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ –û–°: {', '.join(req.supported_os)}
"""
    return description